spring:
  application:
    name: ${APP_NAME:Comeet}

  # 프로필 설정
  profiles:
    active: ${APP_PROFILE:local}

  # Security - 공통 (환경변수 기반)
  security:
    oauth2:
      client:
        provider:
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response

        registration:
          naver:
            client-id: ${CLIENT_ID_NAVER}
            client-secret: ${CLIENT_SECRET_NAVER}
            redirect-uri: ${REDIRECT_URL}
            authorization-grant-type: authorization_code
            client-authentication-method: client_secret_post
            client-name: naver
            scope:
              - nickname
              - email
              - profile_image
  cloud:
    aws:
      credentials:
        access-key: ${AWS_ACCESS_KEY_ID:}
        secret-key: ${AWS_SECRET_ACCESS_KEY:}
      s3:
        bucket: ${AWS_S3_BUCKET:}
      region:
        static: ap-northeast-2

# MyBatis 설정 - 공통
mybatis:
  # Mapper XML 파일 위치
  mapper-locations: classpath:mapper/**/*.xml

  # MyBatis 설정 파일 위치 (선택적)
  # config-location: classpath:mybatis-config.xml

  type-aliases-package: com.backend.domain.*.entity

  configuration:
    # DB의 snake_case를 Java의 camelCase로 자동 변환
    map-underscore-to-camel-case: true

    # 쿼리 로깅 설정
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl

    # 캐시 활성화
    cache-enabled: true

    # Lazy Loading 설정
    lazy-loading-enabled: false
    aggressive-lazy-loading: false

    # JDBC 타임아웃 설정 (초)
    default-statement-timeout: 30

    # NULL 값 처리
    call-setters-on-nulls: true

    # ResultSet에서 컬럼이 없을 때 null 반환
    return-instance-for-empty-row: false

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics

info:
  app:
    name: ${APP_NAME:Comeet}
    version: ${APP_VERSION:1.0.0}
    description: Comeet Backend Application

springdoc:
  swagger-ui:
    path: /
    disable-swagger-default-url: true
    display-request-duration: true
    operations-sorter: alpha
    try-it-out-enabled: true

jwt:
  secret: ${JWT_SECRET}
  accessTokenExpiration: ${JWT_EXPIRATION}
  refreshTokenExpiration: ${JWT_REFRESH_EXPIRATION}

# OpenAI 설정 (GMS 프록시 사용)
spring.ai:
  openai:
    api-key: ${GMS_KEY:}
    base-url: https://gms.ssafy.io/gmsapi/api.openai.com/v1/
    chat:
      completions-path: chat/completions
      options:
        model: gpt-4o
    embedding:
      base-url: https://gms.ssafy.io/gmsapi/api.openai.com/
      options:
        model: text-embedding-3-small

# Redis Vector 설정
redis:
  vector:
    index-name: bean_embeddings
    dimension: 1536
