stages:
  - build

variables:
  GRADLE_OPTS: "-Dorg.gradle.daemon=false -Dorg.gradle.caching=true"
  GRADLE_USER_HOME: "$CI_PROJECT_DIR/.gradle"

cache:
  key:
    files:
      - gradle/wrapper/gradle-wrapper.properties
  paths:
    - .gradle/wrapper
    - .gradle/caches
    - build/classes

# ==========================================
# ë¹Œë“œ ë‹¨ê³„
# ==========================================
build:gradle:
  stage: build
  image: gradle:8.14.2-jdk21
  script:
    - echo "ðŸ”¨ Gradle ë¹Œë“œ ì‹œìž‘..."
    - ./gradlew clean assemble --no-daemon --stacktrace --build-cache
    - echo "âœ… ë¹Œë“œ ì™„ë£Œ"
  artifacts:
    paths:
      - build/libs/*.jar
    expire_in: 1 week
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    - if: $CI_COMMIT_BRANCH =~ /^feature\/\d+$/
  allow_failure: false
